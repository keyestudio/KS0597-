## 4. 教室环境监测显示与报警

### 4.1 教室环境监测显示与报警

在前面的学习中，我们已经掌握了光敏传感器、ENS160空气质量传感器、6812 RGB灯模块和OLED显示屏的使用方法。现在，我们将整合这些技术，开发一个智能教室环境监测系统！

项目功能：

- 实时监测：通过OLED屏显示光照、温湿度、空气质量（eCO₂）
- 智能报警：当参数异常时，RGB灯自动切换颜色提示：
  - 光照异常 → 绿色
  - 温度升高 → 红色
  - 湿度超标 → 蓝色
  - eCO₂浓度过高 → 黄色

这个系统不仅能直观展示教室环境状况，还能通过色彩设计视觉报警，帮助师生快速识别环境问题。现在，让我们开始构建这个集监测、显示与智能报警于一体的装置吧！



#### 流程图

```mermaid
graph TD
    A[开始] --> B[初始化传感器和显示屏]
    B --> C{主循环等待1秒}
    C -->|是| D[读取所有传感器数据]
    D --> E[更新OLED显示]
    E --> F{环境检测}
    
    F -->|光照<1500| G[亮绿灯]
    F -->|温度>30| H[亮红灯]
    F -->|湿度>60| I[亮蓝灯]
    F -->|eCO2>1000| J[亮黄灯]
    F -->|正常| K[关闭LED]
    
    G --> C
    H --> C
    I --> C
    J --> C
    K --> C
```



#### 实验代码

![4_1](../../img/4_1.png)



#### 代码说明

**1.   初始化设置**

![0402](../../img/0402.png)

- 初始化OLED显示屏、清屏、设置文本大小
- 定义变量 temperature、humidity、illum、eco2
- 定义RGB灯的引脚，灯珠数量，灯珠亮度

<br>

**2.  主循环**

![0403](../../img/0403.png)

- 传感器数据读取：

  - AHT20传感器采集温湿度值

  - 光敏传感器读取光照值

  - ENS160传感器测量等效二氧化碳值

![0404](../../img/0404.png)

- OLED 显示更新：清屏，然后显示温湿度、光照、eCO2

![0405](../../img/0405.png)

- RGB LED 灯状态反馈：

  - 低光照（<1500）→ 亮绿灯

  - 高温（>30℃）→ 亮红灯

  - 高湿（>60%）→ 亮蓝灯

  - 高eCO2（>1000ppm）→ 亮黄灯

- 每 2 秒 读取一次传感器数据



#### 实验结果

代码上传成功后，通过AHT20传感器、ENS160传感器和光敏电阻传感器实时采集环境数据并每2秒更新在 OLED 显示屏 ，同时用 RGB LED 提供视觉反馈。

- 低光照（<1500）→ 亮绿灯
- 高温（>30℃）→ 亮红灯
- 高湿（>60%）→ 亮蓝灯
- 高eCO2（>1000ppm）→ 亮黄灯

==动图==
